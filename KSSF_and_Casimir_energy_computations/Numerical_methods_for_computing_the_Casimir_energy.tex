% !TEX root =  main.tex

In this section, we give details of computing the Casimir energy via boundary integral operator discretisations. 
Assume 
$\Omega^{-}\in\mathbb{R}^{d}$, for $d \geq 2$ is the interior bounded Lebesgue-measurable domain that the scatterer occupies with piecewise smooth Lipschitz boundary $\Gamma$. The exterior domain is denoted as 
$\Omega^{+} = \mathbb{R}^{d}\backslash\overline{\Omega^{-}}$. $\boldsymbol{n}$ is the exterior unit normal to the surface $\Gamma$ pointing outwards from $\Omega^{-}$ and 
$\boldsymbol{n}_{\boldsymbol{x}}$ is normal to $\Gamma$ at the point $\boldsymbol{x}\in\Gamma$.

In the scalar case, the Casimir energy can be expressed in terms of certain single-layer boundary operator, which we will define below. We then present its relationship with the Krein-Spectral shift function and demonstrate how it can practically be computed.

\subsection{The single-layer boundary operator}
For the bounded interior domain $\Omega^{-}$ or the unbounded exterior domain $\Omega^{+}$, the space of the (locally) square integrable functions is 
\begin{align*}
    L^{2}(\Omega^{-}) &:= \left\{f:\Omega^{\pm}\rightarrow\mathbb{C}, f \text{ is Lebesgue measurable and} \int_{\Omega^{-}}|f|^{2} < \infty \right\},\\
    L_{\text{loc}}^{2}(\Omega^{+}) &:= \left\{f:\Omega^{+}\rightarrow\mathbb{C},\ f \text{ is Lebesgue measurable and} \int_{K}|f|^{2} < \infty, \ \text{for all compact}\ K \subset \Omega^{+} \right\}
\end{align*}
and note that the subscript ``loc'' can be removed if the domain is bounded (i.e. $L_{\text{loc}}^{2}(\Omega^{-}) = L^{2}(\Omega^{-})$).
We define the (local) Sobolev space $H_{\text{loc}}^{s}(\Omega^{\pm})$ as 
\begin{align*}
    H_{\text{loc}}^{s}(\Omega^{\pm}):=\left\{f\in L_{\text{loc}}^{2}(\Omega^{\pm}), \forall\alpha \text{ s.t.} |\alpha|\leq s, D^{\alpha}f\in L_{\text{loc}}^{2}(\Omega^{\pm})\right\},
\end{align*}
where $\alpha = (\alpha_{1}, \alpha_{2}, \dots, \alpha_{d})$ is a multi-index and $|\alpha| = \alpha_{1} + \alpha_{2} + \dots + \alpha_{d}$, and 
the derivative is defined in the weak sense.

For any function $f\in H_{\text{loc}}^1(\Omega)$ we can define the trace $\gamma_{D}^{\pm}$ as
\begin{align*}
    \gamma_{\text{D}}^{\pm}p(\boldsymbol{x}):=\lim_{\Omega^{\pm}\ni\boldsymbol{x'}\rightarrow\boldsymbol{x}\in\Gamma}p(\boldsymbol{x'}).
\end{align*}
We call the range of the trace operator $H^{1/2}(\Gamma)$. This space can be more rigorously defined. But for the purposes of this paper the description of $H^{1/2}(\Gamma)$ is range space of the trace operator is sufficient. We furthermore need the space $H^{-1/2}(\Gamma)$, which is the dual space of $H^{1/2}(\Gamma)$ with $L^2(\Gamma)$ as pivot space.

We can now define the single-layer boundary $\mathcal{V}:H^{-1/2}(\Gamma)\rightarrow H^{1/2}(\Gamma)$ as

\begin{align*}
    (V_{k}\mu)(\boldsymbol{x}) := \int_{\Gamma}g_{k}(\boldsymbol{x},\boldsymbol{y})\psi(\boldsymbol{y})dS_{\boldsymbol{y}}, \ \ \ \ \ 
    \text{for}\ \mu\in H^{-\frac{1}{2}}(\Gamma) \  \text{and} \ \boldsymbol{x}\in\Gamma.
\end{align*}
Here, 
\begin{align}\label{Green's function}
    g_{k}(\boldsymbol{x},\boldsymbol{y}) = \begin{cases}
          \frac{\mathrm{i}}{4}H_{0}^{(1)}(k|\boldsymbol{x}-\boldsymbol{y}|), \ \ \ \ &\text{for} \ d = 2\\
          \frac{e^{ik|\boldsymbol{x}-\boldsymbol{y}|}}{4\pi|\boldsymbol{x} - \boldsymbol{y}|}, \ \ \ \ &\text{for} \ d = 3,
        \end{cases}
\end{align}
with $H_{0}^{(1)}$  a Hankel function of the first kind.



\subsection{Relation between the Krein spectral shift function and the single-layer boundary operator}
By \cite{hanisch2020relative}, the Krein spectral shift function is defined as 
\begin{align*}
    \xi(k) = \frac{1}{2\pi \mathrm{i}}\log\left(\frac{\det(S(k))}{\det(S_{1,k})\cdots\det(S_{N,k})}\right),
\end{align*}
where $S_{i,n}$ is the scattering matrix associated with the $n$th scatterer. These scattering matrices can be constructed  $S_{i,n} = I + 2T_{i,n}$, where 
$I$ is the identity matrix and $T_{i,n}$ is the $T$-matrix. The method of computing the $T$-matrix is fully discussed in \cite{waterman1969new} and 
\cite{ganesh2008far}.

The following theorem links the single-layer boundary operator with the Krein spectral shift function.
\begin{theorem}\cite{hanisch2020relative}
    Consider $\Omega$ as a domain assembling from individual objects $\Omega_{i}$. Let $V_{k}$ be the single-layer boundary operator defined on the boundary 
    $\partial\Omega = \bigcup_{i = 1}^{N}\partial\Omega_{i}$, and $\tilde{V}_{k}$ is the ``diagonal part'' of $V_{k}$ by restricting the integral 
    kernel to the subset $\bigcup_{i = 1}^{N}\partial\Omega_{i}\times\partial\Omega_{i}\subset\partial\Omega\times\partial\Omega$ then the operator 
    $V_{k}\tilde{V}_{k}^{-1}$ is trace-class and 
    \begin{align*}
        \Xi(k) = \log\det\left(V_{k}\tilde{V}_{k}^{-1}\right).
    \end{align*}

    Then for $k > 0$, we have 
    \begin{align*}
        -\frac{1}{\pi}\emph{\text{Im}}\Xi(k) = \frac{\mathrm{i}}{2\pi}(\Xi(k) - \Xi(-k)) = \xi(k)
    \end{align*}
    and by taking $m = 0$ and $s = 1$ in \eqref{trace formula in terms of the boundary op}, this gives the formula 
    \begin{align}\label{slp and matrix}
        \emph{\text{Tr}}\left(\Delta^{\frac{1}{2}} + (N - 1)\Delta_{0}^{\frac{1}{2}} - \sum_{i = 1}^{N}\Delta_{j}^{\frac{1}{2}}\right)  =  \frac{1}{\pi}\int_{0}^{\infty}\Xi(\mathrm{i}k)dk.
    \end{align}
\end{theorem}

Equation \eqref{slp and matrix} is used to compute the Casimir energy between the objects and the formula is written as
\begin{align}\label{KSSF and CasE}
    \mathcal{E} = -\frac{\hbar c}{2\pi}\int_{0}^{\infty}\Xi(\mathrm{i}k)dk.
\end{align}

% \begin{remark}
%     Note that the integral $\frac{\hbar c}{2}\int_{0}^{\infty}\xi(k)dk$ in \eqref{KSSF and CasE} is not Lebesgue convergent and requires regularisation for its numerical evaluation. The right-hand side integral does not suffer from this issue.
% \end{remark}

{\color{red} Corrected to here}


\subsection{Galerkin discretization and boundary element spaces}
In order to compute the integral \eqref{KSSF and CasE}, we need to compute the log determinant of the operators $V_{k}\tilde{V}_{k}^{-1}$. In this section we discuss Galerkin discretisations to compute this quantity.

Define the 
triangulation $\mathcal{T}_{h}$ of the boundary surface $\Gamma$ with triangular surface elements $\tau_{l}$ and associated nodes $\boldsymbol{x}_{i}$ 
s.t. $\overline{\mathcal{T}_{h}} = \bigcup_{l}\overline{\tau_{l}}$, where $h$ is the mesh size and define the space of the continuous piecewise linear functions
\begin{align*}
    P_{h}^{1}(\Gamma) = \{v_{h}\in C^{0}(\Gamma): v_{h}|_{\tau_{l}}\in\mathbb{P}_{1}(\tau_{l}), \ \text{for} \ \ \tau_{l}\in\mathcal{T}_{h}\},
\end{align*}
where $\mathbb{P}_{1}(\tau_{l})$ denotes the space of polynomials of order less than or equal to 1 on $\tau_{\ell}$. We have

\begin{align*}
    P_{h}^{1}(\Gamma) := \text{span}\{\phi_{j}\} \subset H^{-\frac{1}{2}}(\Gamma)
\end{align*}
with 
\begin{align*}
    \phi_{j}(\boldsymbol{x}_{i}) = \begin{cases}
        1, & i = j,\\
        0, & i\neq j
    \end{cases}
\end{align*}
being the nodal basis functions.

\begin{remark}
Since $H^{-1/2}(\Gamma)$ does not require continuity we could use a space of simple piecewise constant functions. The reason why we choose piecewise linear functions is the size of the arising matrix systems for dense calculations. The computation of the log-determinant requires $\mathcal{O}(n^3)$ operations, where $n$ is the dimension of our approximation basis. For sphere-like and other similar geometries there are in practice roughly twice as many triangles as nodes in the mesh. Hence, while the assembly cost with piecewise linear functions is higher, the resulting matrix has only half the dimension, resulting in roughly a factor eight reduction of computational complexity for the log determinant. A disadvantage is that on geometries with corners or edges the converges close to these singularities is suboptimal with continuous piecewise linear functions.
\end{remark}

Having defined the basis function $\phi_j$, we can represent each element inside the Galerkin discretization form. Assume there are $N$ objects,
then the matrix of the operator $V_{k}$ is an $N$ by $N$ block matrix, written as 
\begin{align}\label{matrix V}
    \mathsf{V}(k) = \begin{bmatrix}
        \mathsf{V}_{11}(k) & \mathsf{V}_{12}(k) & \cdots & \mathsf{V}_{1N}(k) \\
        \mathsf{V}_{21}(k) & \mathsf{V}_{22}(k) & \cdots & \mathsf{V}_{2N}(k) \\
        \vdots & \vdots & \ddots & \vdots \\
        \mathsf{V}_{N1}(k) & \mathsf{V}_{N2}(k) & \cdots & \mathsf{V}_{NN}(k) \\
\end{bmatrix}
\end{align}
and the matrix $\tilde{V}_{k}$ is the diagonal part of $V_{k}$:
\begin{align}\label{matrix tilde V}
    \tilde{\mathsf{V}}(k) = \begin{bmatrix}
        \mathsf{V}_{11}(k) & 0      & \cdots & 0 \\
    0      & \mathsf{V}_{22}(k) & \cdots & 0\\
    \vdots & \vdots & \ddots & \vdots \\
    0      & 0      & \cdots & \mathsf{V}_{NN}(k) \\
\end{bmatrix}.
\end{align}
Therefore, the element in the $m$th row and $n$th column of the block matrix $\mathsf{V}_{ij}(k)$ is 
\begin{align}\label{Elements in matrix V}
    \mathsf{V}_{ij}^{(m,n)} (k) = \langle V_{ij}(k)\phi_{m}^{(i)}, \phi_{n}^{(j)}\rangle = 
    \int_{\Gamma}\overline{\phi_{n}^{(j)}}(\boldsymbol{x})\int_{\Gamma}g_{k}(\boldsymbol{x}, \boldsymbol{y})\phi_{m}^{(i)}(\boldsymbol{y})dS_{\boldsymbol{y}}dS_{\boldsymbol{x}},
\end{align}
where $\boldsymbol{\phi}^{(i)} = \begin{bmatrix}
    \phi_{1}^{(i)} & \phi_{2}^{(i)} & \dots & \phi_{N}^{(i)}
\end{bmatrix}$ is the set of basis functions defined on the $i$th object and 
\begin{align*}
    \langle f, g \rangle = \int_{\Gamma}{f(\boldsymbol{x})}\overline{g(\boldsymbol{x})}dS_{x}
\end{align*}
denotes the standard $L^{2}(\Gamma)$ inner product.


The value of $\Xi(\mathrm{i}k) = \log\det(\mathrm{V}(\mathrm{i}k)\tilde{\mathrm{V}}(\mathrm{i}k)^{-1})$ can now be explicitly computed by evaluating the corresponding log determinants.

The function $\Xi(\mathrm{i}k)$ has a very favourable decay behaviour for growing $k$ that we can use to limit the number of quadrature points necessary to evaluate the corresponding Casimir integral, namely under certain convexity assumptions on the obstacles it holds that
$$
\Xi(\mathrm{i}k) = \mathcal{O}(e^{-2Zk}).
$$
Here, $Z$ is the minimum distance between the obstacles  \cite[Theorem 4.1]{fang2022trace}.

This result can be justified heuristically, using a simple matrix perturbation argument. Consider a symmetric matrix $A$ partitioned as
$$
A = \begin{bmatrix}A_1 & 0\\
                              0   & A_2
       \end{bmatrix}.
$$
and a symmetric matrix $E$ partitioned as
$$
E= \begin{bmatrix}0 & E_1^T\\
     E_1 & 0
     \end{bmatrix}
$$
Then it holds for the $i$th eigenvalue $\lambda_i(A)$ and the $i$th eigenvalue $\lambda_i(A+E)$ that
$$
|\lambda_i(A) - \lambda_i(A+E)| \leq \frac{\|E\|^2}{\text{gap}_i},
$$
where $\text{gap}_i$ is the distance of $\lambda_i(A)$ to the spectrum of $A_2$ if $\lambda_i(A)$ is an eigenvalue of $A_1$, and to the spectrum of $A_1$ if $\lambda_i(A)$ is an eigenvalue of $A_2$. Details can be found in  \cite{mathias1998quadratic} {\color{red} The reference to Roy Matthias is suddenly missing}.

Now assume that we have two different obstacles. Then we have $A_1 = V_{11}(k)$, $A_2 = V_{22}(k)$ and $E_1 = V_{21}$ as the matrix of cross interactions between the two obstacles. The Green's function between two obstacles decays exponentially like $e^{-Zk}$, where $Z$ is the minimal distance between them, resulting in a matrix perturbation result of the form $|\lambda_i(\mathrm{V}) - \lambda_i(\tilde{\mathrm{V}})| = O(e^{-2Zk})$ for increasing $k$, from which the corresponding perturbation result for the log determinant follows.

This purely linear algebraic consideration is not fully robust as it ignores the importance of the eigenvalue gap in the perturbation result. But we can heuristically explain the $\text{gap}$ as follows. On the continuous level the perturbations $E_1$ and $E_2$ are compact, so the tail end of the spectrum that converges to zero with small values of $\text{gap}_i$, is little effected by $E$, and the corresponding eigenvalues have a contribution of $\log \left|\frac{\lambda_i(A)}{\lambda_i(A+E)}\right| \approx 0$ to the value of $\Xi$. The relevant eigenvalues are the larger ones who for distinct obstacles have a sufficiently large value of $\text{gap}_i$.

While the linear algebra argument is useful to give a heuristical explanation, it is not as rigorous as the analytical result in \cite{fang2022trace}. In particular, we want to emphasize that the exponential decay bound with the quadratic factor also holds if the two obstacles are identical, which is not obvious from pure linear algebraic considerations. An example of this is given in Figure \ref{The integrand decays exponentially}.

\begin{figure}[H]
    \centering
    \hspace*{-1cm}\includegraphics[scale = 0.4]{figures/integ_exp_decay.pdf}
    \caption{(Left) Exponential decay of $\Xi(\textrm{i}k)$ for two identical spheres with radius $R=1$ and minimum distance $Z=1.5$. The red line is the decay bound and the blue line is the actual decay. (Right). The integrand $\Xi(ik)$ after varlable transformation to apply a numerical trapezoid rule for its evaluation.}
    \label{The integrand decays exponentially}
\end{figure}

This nice numerical property for the integrand $\Xi(\mathrm{i}k)$  simplifies the numerical integration. One can apply the normal trapezoidal rule to calculate the integral 
$\int_{0}^{\infty}\Xi(\mathrm{i}k)dk = \int_{0}^{\infty}\log\frac{\det\mathsf{V}(\mathrm{i}k)}{\det\tilde{\mathrm{V}}(\mathrm{i}k)}dk$ with $k$ changed to $y$ with $y = e^{-k}$. 
Figure \ref{The integrand decays exponentially} (Right) plots the integrand with regard to the new variable $y$.
